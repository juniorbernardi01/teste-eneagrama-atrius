<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Quem sou eu — Passo 4</title>

<style>
:root{
  --accent:#f07a00;
  --accent-weak: rgba(240,122,0,.12);
  --accent-border: rgba(240,122,0,.45);
  --bg:#f6f7fb;
  --card:#ffffff;
  --bd:#e7e7e7;
  --text:#111;
  --muted:#666;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Arial,sans-serif;
  background:var(--bg);
  color:var(--text);
}
.wrap{max-width:980px;margin:auto;padding:16px;}
.card{
  background:var(--card);
  border-radius:18px;
  padding:16px;
  box-shadow:0 10px 28px rgba(0,0,0,.06);
}
h1{margin:0 0 6px;font-size:32px;}
.muted{color:var(--muted);font-size:14px;line-height:1.4}

.step{margin:12px 0}
.bar{
  height:10px;background:#e9e9e9;border-radius:999px;overflow:hidden;margin-top:6px;
}
.fill{height:100%;width:100%;background:var(--accent);}

.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:12px;
  margin-top:14px;
}
@media(max-width:768px){
  .grid{grid-template-columns:1fr;}
}

.word{
  border:1px solid var(--bd);
  border-radius:16px;
  padding:14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  cursor:pointer;
  background:#fff;
  transition:transform .06s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease;
  -webkit-tap-highlight-color: transparent;
}
.word:hover{box-shadow:0 6px 18px rgba(0,0,0,.06);}
.word:active{transform:scale(.99);}

.left{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:800;
}
.word small{
  color:#888;
  font-weight:800;
  min-width:26px;
  text-align:right;
}

.word input{ transform:scale(1.2); }

/* Card selecionado */
.word.selected{
  background: linear-gradient(0deg, var(--accent-weak), var(--accent-weak));
  border-color: var(--accent-border);
  box-shadow: 0 0 0 3px var(--accent-weak);
}

.actions{
  display:flex;
  gap:10px;
  margin-top:16px;
  flex-wrap:wrap;
}
.btn{
  padding:14px 16px;
  border-radius:14px;
  border:0;
  font-weight:900;
  cursor:pointer;
}
.btn-primary{
  background:var(--accent);
  color:#fff;
  flex:1;
  min-width:220px;
}
.btn-outline{
  background:#fff;
  border:1px solid var(--bd);
}

/* avisos */
.notice{
  margin-top:10px;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--bd);
  background:#fafafa;
  font-size:13px;
  color:#333;
}
.notice b{color:#111}
</style>
</head>

<body>
<div class="wrap">
  <div class="card">

    <h1>Quem sou eu</h1>
    <p class="muted">Marque apenas as palavras ou expressões que realmente combinam com você ao longo da vida.</p>

    <div class="step">
      <b>Passo 4 de 4 — Identificação pessoal</b>
      <div class="bar"><div class="fill"></div></div>
    </div>

    <p class="muted">
      <b>Instruções:</b> Selecione as palavras que mais se parecem com você.
      Para continuar, selecione pelo menos <b>6 opções</b>.
    </p>

    <div id="msg" class="notice" style="display:none"></div>

    <form id="formP4">
      <div class="grid" id="gridWords"></div>

      <div class="actions">
        <button type="button" class="btn btn-outline" id="btnBack">Voltar</button>
        <button type="button" id="btnFinish" class="btn btn-primary">Ver resultado</button>
      </div>
    </form>

  </div>
</div>

<script>
const KEY="respostas";
const MIN=6;

// ✅ Lista maior (o dobro, como você pediu)
// Você pode editar/ajustar livremente depois.
const palavras = [
  "Comprometido(a)","Cuidadoso(a)","Determinado(a)","Competitivo(a)","Analítico(a)","Reservado(a)",
  "Organizado(a)","Prático(a)","Independente","Leal","Intenso(a)","Flexível",
  "Persistente","Disciplinado(a)","Observador(a)","Responsável","Focado(a)","Autêntico(a)",
  "Sensível","Protetor(a)","Questionador(a)","Cauteloso(a)","Otimista","Entusiasmado(a)",
  "Direto(a)","Assertivo(a)","Tranquilo(a)","Harmonioso(a)","Criativo(a)","Curioso(a)",
  "Exigente consigo mesmo(a)","Prestativo(a)","Ambicioso(a)","Intuitivo(a)","Discreto(a)","Visionário(a)",

  "Carismático(a)","Prudente","Sociável","Contido(a)","Aventureiro(a)","Confiável",
  "Perfeccionista","Pragmático(a)","Acolhedor(a)","Decidido(a)","Resiliente","Estrategista",
  "Detalhista","Objetivo(a)","Inspirador(a)","Empático(a)","Realista","Inconformado(a)",
  "Calmo(a)","Corajoso(a)","Confiante","Leve","Inovador(a)","Paciente",
  "Forte","Persistente","Idealista","Reservado(a)","Espontâneo(a)","Líder",
  "Mediador(a)","Intenso(a)","Disciplinado(a)","Comunicativo(a)","Proativo(a)","Observador(a)"
];

function getList(){
  try{ return JSON.parse(localStorage.getItem(KEY)) || []; }
  catch{ return []; }
}
function setList(l){ localStorage.setItem(KEY, JSON.stringify(l)); }

// cada palavra é um checkbox salvo como: {pergunta:"P4_01", alternativa:"S"}
function upsertCheckbox(name, checked){
  let l = getList().filter(x => x.pergunta !== name);
  if(checked) l.push({ pergunta:name, alternativa:"S" });
  setList(l);
}

function countSelected(){
  return document.querySelectorAll('#formP4 input[type="checkbox"]:checked').length;
}

function showMsg(text){
  const box = document.getElementById("msg");
  box.style.display = "block";
  box.innerHTML = text;
}

function hideMsg(){
  const box = document.getElementById("msg");
  box.style.display = "none";
  box.innerHTML = "";
}

function build(){
  const grid = document.getElementById("gridWords");
  grid.innerHTML = palavras.map((p, i) => {
    const n = String(i+1).padStart(2,"0");
    return `
      <div class="word" data-name="P4_${n}" role="button" tabindex="0" aria-label="${p}">
        <span class="left"><small>${i+1}.</small>${p}</span>
        <input type="checkbox" name="P4_${n}" aria-label="${p}">
      </div>
    `;
  }).join("");

  // clique no card deve alternar o check
  grid.querySelectorAll(".word").forEach(card=>{
    const cb = card.querySelector('input[type="checkbox"]');

    function syncUI(){
      card.classList.toggle("selected", cb.checked);
      upsertCheckbox(cb.name, cb.checked);
      // opcional: mostra aviso só quando está abaixo do mínimo
      if(countSelected() >= MIN) hideMsg();
    }

    // clique no card
    card.addEventListener("click", (e)=>{
      // se clicou no checkbox, deixa ele agir e só sincroniza no change
      if(e.target === cb) return;
      cb.checked = !cb.checked;
      syncUI();
    });

    // teclado (Enter/Espaço)
    card.addEventListener("keydown", (e)=>{
      if(e.key === "Enter" || e.key === " "){
        e.preventDefault();
        cb.checked = !cb.checked;
        syncUI();
      }
    });

    // mudança direta no checkbox
    cb.addEventListener("change", syncUI);
  });
}

function restore(){
  const l = getList();
  l.forEach(r=>{
    if(!r.pergunta.startsWith("P4_")) return;
    const cb = document.querySelector(`#formP4 input[name="${r.pergunta}"]`);
    if(cb){
      cb.checked = true;
      const card = cb.closest(".word");
      if(card) card.classList.add("selected");
    }
  });
}

document.addEventListener("DOMContentLoaded",()=>{
  build();
  restore();

  document.getElementById("btnBack").addEventListener("click", ()=>{
    history.back();
  });

  document.getElementById("btnFinish").addEventListener("click", ()=>{
    const n = countSelected();
    if(n < MIN){
      showMsg(`Selecione pelo menos <b>${MIN}</b> opções para continuar. Atualmente: <b>${n}</b>.`);
      return;
    }
    // ✅ vai para o resultado na raiz
    window.location.href = "../resultado.html";
  });
});
</script>

</body>
</html>
